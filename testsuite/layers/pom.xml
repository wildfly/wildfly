<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.wildfly</groupId>
        <artifactId>wildfly-testsuite</artifactId>
        <!--
        Maintain separation between the artifact id and the version to help prevent
        merge conflicts between commits changing the GA and those changing the V.
        -->
        <version>27.0.0.Beta1-SNAPSHOT</version>
    </parent>

    <artifactId>wildfly-ts-layers</artifactId>
    <packaging>jar</packaging>
    <name>WildFly Test Suite: Galleon Layers</name>

    <dependencies>
        <dependency>
            <groupId>org.wildfly.core</groupId>
            <artifactId>wildfly-core-testsuite-shared</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>javax.activation</groupId>
                    <artifactId>activation</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javax.xml.bind</groupId>
                    <artifactId>jaxb-api</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.wildfly.core</groupId>
            <artifactId>wildfly-launcher</artifactId>
        </dependency>
    </dependencies>
    
    <properties>
        <layers.install.dir>layers-results</layers.install.dir>
        <!-- Put 'servlet' installations in the same dir as others. Set this to
             a different dir if testing the servlet feature pack. -->
        <servlet.layers.install.dir>${layers.install.dir}</servlet.layers.install.dir>
        <!-- An empty layer for this will disable 'servlet dist' tests which are meant for testing
             the servlet feature pack. -->
        <servlet.layers.install.root>servlet-layers-results</servlet.layers.install.root>
        <layers.delete.installations>true</layers.delete.installations>
        <jbossas.project.dir>${jbossas.ts.dir}/../..</jbossas.project.dir>
        
        <!-- GAVs to use for feature packs. Profiles can reset to trigger provisioning
             using alternative feature packs. -->
        <servlet.feature.pack.groupId>${testsuite.ee.galleon.pack.groupId}</servlet.feature.pack.groupId>
        <servlet.feature.pack.artifactId>${testsuite.ee.galleon.pack.artifactId}</servlet.feature.pack.artifactId>
        <ee.feature.pack.groupId>${testsuite.ee.galleon.pack.groupId}</ee.feature.pack.groupId>
        <ee.feature.pack.artifactId>${testsuite.ee.galleon.pack.artifactId}</ee.feature.pack.artifactId>
        <ee.feature.pack.version>${testsuite.ee.galleon.pack.version}</ee.feature.pack.version>
        <full.feature.pack.artifactId>wildfly-galleon-pack</full.feature.pack.artifactId>

        <!-- Where to look for artifacts when provisioning and running. -->
        <maven.repo.local>${settings.localRepository}</maven.repo.local>

        <!-- Props to control what phase plugin executions run in.
             Default is none. Profiles set these to other values to enable executions.
             Provisioning executions using the wildfly-test-galleon-pack are handled separately from others. -->
        <provisioning.phase>none</provisioning.phase>
        <provisioning.phase.preview.excluded>none</provisioning.phase.preview.excluded>
        <!-- Don't run the default surefire execution unless a profile enables it -->
        <surefire.default-test.phase>none</surefire.default-test.phase>
    </properties>

    <profiles>
        <profile>
            <id>layers.profile</id>
            <activation>
                <property>
                    <name>ts.layers</name>
                </property>
            </activation>
            <properties>
                <!-- Turn on normal plugin execution by changing the phase props from 'none' -->
                <provisioning.phase>compile</provisioning.phase>
                <provisioning.phase.preview.excluded>compile</provisioning.phase.preview.excluded>
                <surefire.default-test.phase>test</surefire.default-test.phase>
            </properties>
        </profile>

        <!-- Test against EE 9 feature packs -->
        <profile>
            <id>ee9.profile</id>
            <activation>
                <property>
                    <name>ts.ee9</name>
                </property>
            </activation>
            <properties>
                <!-- Turn on normal plugin execution by changing the phase props from 'none'.
                     Note that we leave 'provisioning.phase.preview.excluded' as 'none' -->
                <provisioning.phase>compile</provisioning.phase>
                <surefire.default-test.phase>test</surefire.default-test.phase>
                <!-- Reset the feature pack GAV props to use wildfly-preview -->
                <servlet.feature.pack.artifactId>wildfly-preview-feature-pack</servlet.feature.pack.artifactId>
                <ee.feature.pack.groupId>${project.groupId}</ee.feature.pack.groupId>
                <ee.feature.pack.artifactId>wildfly-preview-feature-pack</ee.feature.pack.artifactId>
                <ee.feature.pack.version>${project.version}</ee.feature.pack.version>
                <full.feature.pack.artifactId>wildfly-preview-feature-pack</full.feature.pack.artifactId>
                <!-- Use the transformed artifact repo -->
                <maven.repo.local>${wildfly.transformed.repo.dir}</maven.repo.local>
                <!-- We don't use a 'servlet feature pack' so don't provision any servers in the dir the servlet test checks -->
                <servlet.layers.install.dir>${layers.install.dir}</servlet.layers.install.dir>
                <!-- An empty value for this will disable the servlet test -->
                <servlet.layers.install.root></servlet.layers.install.root>
            </properties>
        </profile>
    </profiles>
    
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.wildfly.plugins</groupId>
                        <artifactId>wildfly-maven-plugin</artifactId>
                        <version>${version.org.wildfly.plugin}</version>
                        <configuration>
                            <record-provisioning-state>false</record-provisioning-state>
                            <log-provisioning-time>${galleon.log.time}</log-provisioning-time>
                            <offline-provisioning>${galleon.offline}</offline-provisioning>
                            <galleon-options>
                                <jboss-maven-dist/>
                                <jboss-jakarta-transform-artifacts>false</jboss-jakarta-transform-artifacts>
                                <jboss-maven-provisioning-repo>${maven.repo.local}</jboss-maven-provisioning-repo>
                                <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>
                                <optional-packages>passive+</optional-packages>
                            </galleon-options>
                        </configuration>
                        <!--
                            Keep the executions that use Galleon layers defined only in the wildfly-galleon-pack
                            grouped together at the end of this executions list
                        -->
                        <executions>
                            <execution>
                                <id>cloud-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-server</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-server-clustered</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-server-decorated</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-server-h2</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>h2-default-datasource</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-jpa-distributed-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-server-h2</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>jpa-distributed</layer>
                                        <layer>h2-default-datasource</layer>
                                    </layers>
                                    <excluded-layers>
                                        <layer>jpa</layer>
                                    </excluded-layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server-clustered</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server-decorated</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>observability</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server-h2</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>observability</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-jpa-distributed-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server-h2</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>jpa-distributed</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-observability-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources-web-server-observability</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources-web-server</layer>
                                        <layer>observability</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>iiop-openjdk-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/iiop-openjdk-server</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>iiop-openjdk</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs-server</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs-server</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs-server-clustered</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs-server</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs-server-decorated</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>observability</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs-server-h2</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs-server</layer>
                                        <layer>h2-default-datasource</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-observability-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs-server-observability</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs-server</layer>
                                        <layer>observability</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jpa-distributed-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jpa-distributed</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jpa-distributed</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-clustering-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/web-clustering</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-clustering</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-passivation-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/web-passivation</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-passivation</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <!-- servlet layers. Most of these we now by default provision
                                 from the wildfly-ee feature pack -->
                            <execution>
                                <!-- Build the test-standalone-reference from the servlet feature pack.
                                     This is not a layer test. It's a test of the standard standalone.xml
                                     produced by a feature pack and we have another execution that
                                     does the same for wildfly-ee. -->
                                <id>test-standalone-reference-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/test-standalone-reference</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>wildfly-servlet-galleon-pack</artifactId>
                                            <version>${ee.maven.version}</version>
                                        </feature-pack>
                                    </feature-packs>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/ee</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ee</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-https-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/undertow-https</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>undertow-https</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-load-balancer-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/undertow-load-balancer</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>undertow-load-balancer</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>naming-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/naming</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>naming</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/undertow</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>undertow</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-server-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/web-server</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${servlet.feature.pack.groupId}</groupId>
                                            <artifactId>${servlet.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-server</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <!-- Build the test-all-layers from the servlet feature pack.
                                 LayersTest.test expects to find this installation
                                 We have another execution that does the same for wildfly-ee. -->
                            <execution>
                                <id>all-layers-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <provisioning-dir>${servlet.layers.install.root}/test-all-layers</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>wildfly-servlet-galleon-pack</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ee</layer>
                                        <layer>undertow-load-balancer</layer>
                                        <layer>naming</layer>
                                        <layer>undertow</layer>
                                        <layer>undertow-https</layer>
                                        <layer>web-server</layer>
                                        <!-- core-server, core-tools are from core,
                                        required to compare all layers with reference installation -->
                                        <layer>core-server</layer>
                                        <layer>core-tools</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <!-- wildfly layers -->
                            <execution>
                                <id>batch-jberet-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/batch-jberet</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>batch-jberet</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>bean-validation-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/bean-validation</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>bean-validation</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cdi-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cdi</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cdi</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-profile-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/cloud-profile</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-profile</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/datasources</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>datasources</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ee</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ee</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-security-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ee-security</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ee-security</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-lite-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb-lite</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb-lite</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-lite-dist-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb-lite-dist-cache</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb-lite</layer>
                                        <layer>ejb-dist-cache</layer>
                                    </layers>
                                    <excluded-layers>
                                        <layer>ejb-local-cache</layer>
                                    </excluded-layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-dist-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb-dist-cache</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb-dist-cache</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-http-invoker-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb-http-invoker</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb-http-invoker</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-local-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/ejb-local-cache</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>ejb-local-cache</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-datasource-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/h2-datasource</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-profile</layer>
                                        <layer>h2-datasource</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-default-datasource-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/h2-default-datasource</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-server</layer>
                                        <layer>jpa</layer>
                                        <layer>h2-default-datasource</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-driver-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/h2-driver</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-server</layer>
                                        <layer>jpa</layer>
                                        <layer>h2-driver</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jaxrs</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jaxrs</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jdr-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jdr</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jdr</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jms-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jms-activemq</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jms-activemq</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsonp-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jsonp</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jsonp</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsonb-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jsonb</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jsonb</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>remote-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/remote-activemq</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>remote-activemq</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jpa-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jpa</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jpa</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsf-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/jsf</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>jsf</layer>
                                    </layers>
                                </configuration>
                            </execution>

                            <!-- Mail provisioning -->
                            <execution>
                                <id>mail-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/mail</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>mail</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>messaging-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/messaging-activemq</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>messaging-activemq</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>observability-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/observability</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>observability</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>opentelemetry-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/opentelemetry</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>opentelemetry</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>pojo-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/pojo</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>pojo</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>resource-adapters-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/resource-adapters</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>resource-adapters</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <!-- SAR provisioning -->
                            <execution>
                                <id>sar-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/sar</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>sar</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>transactions-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/transactions</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>transactions</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/undertow</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>undertow</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-console-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/web-console</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>web-console</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>webservices-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/webservices</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>webservices</layer>
                                    </layers>
                                </configuration>
                            </execution>

                            <!--
                                Galleon layers defined only in wildfly-galleon-pack
                             -->
                            <execution>
                                <id>microprofile-platform-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-platform</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-platform</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-config-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-config</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-config</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-health-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-health</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-health</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-metrics-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-metrics</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-metrics</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-openapi-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-openapi</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-openapi</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-fault-tolerance-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-fault-tolerance</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-fault-tolerance</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-jwt-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-jwt</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-jwt</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-standalone-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-standalone</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>microprofile-fault-tolerance</layer>
                                        <layer>microprofile-jwt</layer>
                                        <layer>microprofile-openapi</layer>
                                        <layer>undertow-https</layer>
                                        <layer>web-passivation</layer>
                                    </layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>microprofile-standalone-ha-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/microprofile-standalone-ha</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>cloud-server</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>microprofile-fault-tolerance</layer>
                                        <layer>microprofile-jwt</layer>
                                        <layer>microprofile-openapi</layer>
                                        <layer>undertow-https</layer>
                                        <layer>jpa-distributed</layer>
                                        <layer>web-clustering</layer>
                                    </layers>
                                    <excluded-layers>
                                        <layer>jpa</layer>
                                    </excluded-layers>
                                </configuration>
                            </execution>
                            <execution>
                                <id>open-tracing-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/open-tracing</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>microprofile-opentracing</layer>
                                    </layers>
                                </configuration>
                            </execution>

                            <!--
                                All layers provisioned all together
                             -->
                            <execution>
                                <id>all-layers-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/test-all-layers</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>base-server</layer>
                                        <layer>batch-jberet</layer>
                                        <layer>bean-validation</layer>
                                        <layer>cdi</layer>
                                        <layer>cloud-profile</layer>
                                        <layer>cloud-server</layer>
                                        <layer>core-management</layer>
                                        <layer>core-server</layer>
                                        <layer>core-tools</layer>
                                        <layer>datasources</layer>
                                        <layer>datasources-web-server</layer>
                                        <layer>deployment-scanner</layer>
                                        <layer>discovery</layer>
                                        <layer>ee</layer>
                                        <layer>ee-security</layer>
                                        <layer>ejb</layer>
                                        <layer>ejb-http-invoker</layer>
                                        <layer>ejb-lite</layer>
                                        <layer>ejb-local-cache</layer>
                                        <layer>elytron</layer>
                                        <layer>h2-datasource</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>h2-driver</layer>
                                        <layer>iiop-openjdk</layer>
                                        <layer>io</layer>
                                        <layer>jaxrs</layer>
                                        <layer>jaxrs-server</layer>
                                        <layer>jdr</layer>
                                        <layer>jms-activemq</layer>
                                        <layer>jmx</layer>
                                        <layer>jmx-remoting</layer>
                                        <layer>jpa</layer>
                                        <layer>jsf</layer>
                                        <layer>jsonb</layer>
                                        <layer>jsonp</layer>
                                        <layer>logging</layer>
                                        <layer>mail</layer>
                                        <layer>management</layer>
                                        <layer>messaging-activemq</layer>
                                        <layer>naming</layer>
                                        <layer>observability</layer>
                                        <layer>opentelemetry</layer>
                                        <layer>pojo</layer>
                                        <layer>remote-activemq</layer>
                                        <layer>remoting</layer>
                                        <layer>request-controller</layer>
                                        <layer>resource-adapters</layer>
                                        <layer>sar</layer>
                                        <layer>security-manager</layer>
                                        <layer>transactions</layer>
                                        <layer>undertow</layer>
                                        <layer>undertow-https</layer>
                                        <layer>undertow-load-balancer</layer>
                                        <layer>web-passivation</layer>
                                        <layer>web-console</layer>
                                        <layer>web-server</layer>
                                        <layer>webservices</layer>
                                        <!--
                                            Galleon layers defined only in the wildfly-galleon-pack
                                         -->
                                        <layer>microprofile-config</layer>
                                        <layer>microprofile-fault-tolerance</layer>
                                        <layer>microprofile-health</layer>
                                        <layer>microprofile-jwt</layer>
                                        <layer>microprofile-metrics</layer>
                                        <layer>microprofile-openapi</layer>
                                        <layer>microprofile-opentracing</layer>
                                        <layer>microprofile-platform</layer>
                                    </layers>
                                </configuration>
                            </execution>

                            <!-- This is an all layers variant excluding jpa and adding jpa-distributed -->
                            <execution>
                                <id>all-layers-jpa-distributed-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/test-all-layers-jpa-distributed</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${full.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>base-server</layer>
                                        <layer>batch-jberet</layer>
                                        <layer>bean-validation</layer>
                                        <layer>cdi</layer>
                                        <layer>cloud-profile</layer>
                                        <layer>cloud-server</layer>
                                        <layer>core-management</layer>
                                        <layer>core-server</layer>
                                        <layer>core-tools</layer>
                                        <layer>datasources</layer>
                                        <layer>datasources-web-server</layer>
                                        <layer>deployment-scanner</layer>
                                        <layer>discovery</layer>
                                        <layer>ee</layer>
                                        <layer>ee-security</layer>
                                        <layer>ejb</layer>
                                        <layer>ejb-dist-cache</layer>
                                        <layer>ejb-http-invoker</layer>
                                        <layer>ejb-lite</layer>
                                        <layer>elytron</layer>
                                        <layer>h2-datasource</layer>
                                        <layer>h2-default-datasource</layer>
                                        <layer>h2-driver</layer>
                                        <layer>iiop-openjdk</layer>
                                        <layer>io</layer>
                                        <layer>jaxrs</layer>
                                        <layer>jaxrs-server</layer>
                                        <layer>jdr</layer>
                                        <layer>jms-activemq</layer>
                                        <layer>jmx</layer>
                                        <layer>jmx-remoting</layer>
                                        <layer>jpa-distributed</layer>
                                        <layer>jsf</layer>
                                        <layer>jsonb</layer>
                                        <layer>jsonp</layer>
                                        <layer>logging</layer>
                                        <layer>mail</layer>
                                        <layer>management</layer>
                                        <layer>messaging-activemq</layer>
                                        <layer>naming</layer>
                                        <layer>observability</layer>
                                        <layer>opentelemetry</layer>
                                        <layer>pojo</layer>
                                        <layer>remote-activemq</layer>
                                        <layer>remoting</layer>
                                        <layer>request-controller</layer>
                                        <layer>resource-adapters</layer>
                                        <layer>sar</layer>
                                        <layer>security-manager</layer>
                                        <layer>transactions</layer>
                                        <layer>undertow</layer>
                                        <layer>undertow-https</layer>
                                        <layer>undertow-load-balancer</layer>
                                        <layer>web-clustering</layer>
                                        <layer>web-console</layer>
                                        <layer>web-server</layer>
                                        <layer>webservices</layer>
                                        <!--
                                            Galleon layers defined only in the wildfly-galleon-pack
                                         -->
                                        <layer>microprofile-config</layer>
                                        <layer>microprofile-fault-tolerance</layer>
                                        <layer>microprofile-health</layer>
                                        <layer>microprofile-jwt</layer>
                                        <layer>microprofile-metrics</layer>
                                        <layer>microprofile-openapi</layer>
                                        <layer>microprofile-opentracing</layer>
                                        <layer>microprofile-platform</layer>
                                    </layers>
                                    <excluded-layers>
                                        <layer>jpa</layer>
                                    </excluded-layers>
                                </configuration>
                            </execution>
                            <!-- Core Layers - These can't be tested in Core as they require Undertow -->
                            <execution>
                                <id>remoting-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <provisioning-dir>${layers.install.dir}/remoting</provisioning-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <layers>
                                        <layer>remoting</layer>
                                        <layer>undertow</layer>
                                    </layers>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>

                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <systemPropertyVariables>
                                <!-- maven.local.repo is set in parent pom.xml, system property surefire.system.args -->
                                <servlet.layers.install.root>${project.build.directory}/${servlet.layers.install.root}</servlet.layers.install.root>
                                <layers.install.root>${project.build.directory}/${layers.install.dir}</layers.install.root>
                                <jbossas.version>${project.parent.version}</jbossas.version>
                                <cleanup.tmp>${cleanup.tmp}</cleanup.tmp>
                                <layers.delete.installations>${layers.delete.installations}</layers.delete.installations>
                                <maven.repo.local>${maven.repo.local}</maven.repo.local>
                            </systemPropertyVariables>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
    
</project>
