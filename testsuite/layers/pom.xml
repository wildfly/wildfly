<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.wildfly</groupId>
        <artifactId>wildfly-testsuite</artifactId>
        <!--
        Maintain separation between the artifact id and the version to help prevent
        merge conflicts between commits changing the GA and those changing the V.
        -->
        <version>30.0.0.Beta1-SNAPSHOT</version>
    </parent>

    <artifactId>wildfly-ts-layers</artifactId>
    <packaging>jar</packaging>
    <name>WildFly Test Suite: Galleon Layers -- Base</name>

    <dependencies>
        <dependency>
            <groupId>org.wildfly.core</groupId>
            <artifactId>wildfly-core-testsuite-shared</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>javax.activation</groupId>
                    <artifactId>activation</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javax.xml.bind</groupId>
                    <artifactId>jaxb-api</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.wildfly.core</groupId>
            <artifactId>wildfly-launcher</artifactId>
        </dependency>
        <dependency>
            <groupId>org.wildfly.security</groupId>
            <artifactId>wildfly-elytron-security-manager</artifactId>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>wildfly-testsuite-shared</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>*</groupId>
                    <artifactId>*</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <properties>
        <layers.install.dir>${project.build.directory}/layers-results</layers.install.dir>
        <layers.delete.installations>true</layers.delete.installations>
        <jbossas.project.dir>${jbossas.ts.dir}/../..</jbossas.project.dir>

        <!-- GAVs to use for feature packs. Profiles can reset to trigger provisioning
             using alternative feature packs. -->
        <ee.feature.pack.groupId>${testsuite.ee.galleon.pack.groupId}</ee.feature.pack.groupId>
        <ee.feature.pack.artifactId>${testsuite.ee.galleon.pack.artifactId}</ee.feature.pack.artifactId>
        <ee.feature.pack.version>${testsuite.ee.galleon.pack.version}</ee.feature.pack.version>

        <!-- Where to look for artifacts when provisioning and running. -->
        <maven.repo.local>${settings.localRepository}</maven.repo.local>

        <!-- Props to control what phase plugin executions run in.
             Default is none. Profiles set these to other values to enable executions.
             Provisioning executions using the wildfly-test-galleon-pack are handled separately from others. -->
        <provisioning.phase>none</provisioning.phase>
        <provisioning.phase.preview.excluded>none</provisioning.phase.preview.excluded> <!-- Use for executions that won't work with WildFly Preview -->
        <provisioning.phase.preview.only>none</provisioning.phase.preview.only> <!-- Use for executions that will only work with WildFly Preview -->
        <!-- Don't run the default surefire execution unless a profile enables it -->
        <surefire.default-test.phase>none</surefire.default-test.phase>
        
        <!-- default configs provisioned with passive+ -->
        <std.default.install.dir>${project.build.directory}/std-configs</std.default.install.dir>
    </properties>

    <profiles>
        <profile>
            <id>layers.profile</id>
            <activation>
                <property>
                    <name>ts.layers</name>
                </property>
            </activation>
            <properties>
                <!-- Turn on normal plugin execution by changing the phase props from 'none' -->
                <provisioning.phase>compile</provisioning.phase>
                <provisioning.phase.preview.excluded>compile</provisioning.phase.preview.excluded>
                <surefire.default-test.phase>test</surefire.default-test.phase>
            </properties>
        </profile>

        <!-- Test against EE 9 feature packs -->
        <profile>
            <id>ee9.profile</id>
            <activation>
                <property>
                    <name>ts.ee9</name>
                </property>
            </activation>
            <properties>
                <!-- Turn on normal plugin execution by changing the phase props from 'none'.
                     Note that we leave 'provisioning.phase.preview.excluded' as 'none' -->
                <provisioning.phase>compile</provisioning.phase>
                <provisioning.phase.preview.only>compile</provisioning.phase.preview.only>
                <surefire.default-test.phase>test</surefire.default-test.phase>
                <!-- Reset the feature pack GAV props to use wildfly-preview -->
                <ee.feature.pack.groupId>${project.groupId}</ee.feature.pack.groupId>
                <ee.feature.pack.artifactId>wildfly-preview-feature-pack</ee.feature.pack.artifactId>
                <ee.feature.pack.version>${project.version}</ee.feature.pack.version>
                <!-- Use the transformed artifact repo -->
                <maven.repo.local>${settings.localRepository}</maven.repo.local>
            </properties>
        </profile>
    </profiles>

            <build>
                <plugins>
                    <plugin>
                        <groupId>org.jboss.galleon</groupId>
                        <artifactId>galleon-maven-plugin</artifactId>
                        <configuration>
                            <record-state>true</record-state>
                            <log-time>${galleon.log.time}</log-time>
                            <offline>${galleon.offline}</offline>
                            <plugin-options>
                                <jboss-maven-dist/>
                                <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>
                                <optional-packages>passive+</optional-packages>
                                <!-- What std WF and WFP provision can differ, and we may exclude some
                                     layers for one which don't exist in the other.
                                     So tell Galleon to ignore this. -->
                                <ignore-not-excluded-layers>true</ignore-not-excluded-layers>
                            </plugin-options>
                        </configuration>
                        <!--
                            Keep the executions that use Galleon layers defined only in the wildfly-galleon-pack
                            grouped together at the end of this executions list
                        -->
                        <executions>
                            <execution>
                                <id>cloud-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-server</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-server</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-server-clustered</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-server</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-server-decorated</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-server</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-server-h2</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-server</layer>
                                                <layer>h2-default-datasource</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-server-jpa-distributed-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-server-h2</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-server</layer>
                                                <layer>jpa-distributed</layer>
                                                <layer>h2-default-datasource</layer>
                                            </layers>
                                            <excluded-layers>
                                                <layer>jpa</layer>
                                            </excluded-layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server-clustered</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server-decorated</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>observability</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server-h2</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                                <layer>h2-default-datasource</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-jpa-distributed-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server-h2</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>jpa-distributed</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-web-server-observability-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources-web-server-observability</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources-web-server</layer>
                                                <layer>observability</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>embedded-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/embedded-activemq</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>embedded-activemq</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>iiop-openjdk-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/iiop-openjdk-server</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>iiop-openjdk</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs-server</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs-server</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-clustered-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs-server-clustered</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs-server</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-decorated-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs-server-decorated</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs-server</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>observability</layer>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-h2-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs-server-h2</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs-server</layer>
                                                <layer>h2-default-datasource</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-server-observability-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs-server-observability</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs-server</layer>
                                                <layer>observability</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jpa-distributed-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jpa-distributed</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jpa-distributed</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-clustering-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/web-clustering</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-clustering</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-passivation-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/web-passivation</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-passivation</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <!-- Former wildfly-servlet layers. We now by default provision
                                 from the wildfly-ee feature pack -->
                            <execution>
                                <!-- Build the test-standalone-reference from the wildfly-ee feature pack.
                                     This is not a layer test. It's a test of the standard standalone.xml
                                      produced by a feature pack. -->
                                <id>test-standalone-reference-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/test-standalone-reference</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <included-configs>
                                                <config>
                                                    <model>standalone</model>
                                                    <name>standalone.xml</name>
                                                </config>
                                            </included-configs>
                                        </feature-pack>
                                    </feature-packs>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-https-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/undertow-https</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>undertow-https</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-load-balancer-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/undertow-load-balancer</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>undertow-load-balancer</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>naming-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/naming</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>naming</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-server-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/web-server</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-server</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <!-- wildfly layers -->
                            <execution>
                                <id>batch-jberet-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/batch-jberet</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>batch-jberet</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>bean-validation-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/bean-validation</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>bean-validation</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cdi-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cdi</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cdi</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>cloud-profile-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/cloud-profile</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-profile</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>datasources-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/datasources</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>datasources</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ee</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ee</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-concurrency-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ee-concurrency</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ee-concurrency</layer>
                                                <layer>servlet</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-integration-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ee-integration</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ee-integration</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ee-security-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ee-security</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ee-security</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-lite-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb-lite</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb-lite</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-lite-dist-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb-lite-dist-cache</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb-lite</layer>
                                                <layer>ejb-dist-cache</layer>
                                            </layers>
                                            <excluded-layers>
                                                <layer>ejb-local-cache</layer>
                                            </excluded-layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-dist-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb-dist-cache</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb-dist-cache</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-http-invoker-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb-http-invoker</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb-http-invoker</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>ejb-local-cache-provisioning-test</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/ejb-local-cache</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>ejb-local-cache</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>hibernate-search-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/hibernate-search</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>hibernate-search</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>hibernate-search-jpa-distributed-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/hibernate-search-jpa-distributed</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>hibernate-search</layer>
                                                <layer>jpa-distributed</layer>
                                            </layers>
                                            <excluded-layers>
                                                <layer>jpa</layer>
                                            </excluded-layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-datasource-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/h2-datasource</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>cloud-profile</layer>
                                                <layer>h2-datasource</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-default-datasource-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/h2-default-datasource</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-server</layer>
                                                <layer>jpa</layer>
                                                <layer>h2-default-datasource</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>h2-driver-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/h2-driver</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-server</layer>
                                                <layer>jpa</layer>
                                                <layer>h2-driver</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jaxrs-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jaxrs</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jaxrs</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jdr-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jdr</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jdr</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jms-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jms-activemq</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jms-activemq</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsonp-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jsonp</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jsonp</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsonb-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jsonb</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jsonb</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>remote-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/remote-activemq</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>remote-activemq</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jpa-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jpa</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jpa</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jsf-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/jsf</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>jsf</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                            <!-- Mail provisioning -->
                            <execution>
                                <id>mail-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/mail</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>mail</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                            <execution>
                                <id>messaging-activemq-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/messaging-activemq</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>messaging-activemq</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                            <execution>
                                <id>mod_cluster-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/mod_cluster</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>mod_cluster</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                            <execution>
                                <id>observability-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/observability</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>observability</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>opentelemetry-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/opentelemetry</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>opentelemetry</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>pojo-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/pojo</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>pojo</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>resource-adapters-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/resource-adapters</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>resource-adapters</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <!-- SAR provisioning -->
                            <execution>
                                <id>sar-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/sar</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>sar</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>singleton-local-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/singleton-local</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>singleton-local</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>singleton-ha-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/singleton-ha</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>singleton-ha</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>transactions-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/transactions</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>transactions</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>undertow-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/undertow</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>undertow</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>web-console-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/web-console</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>web-console</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>webservices-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/webservices</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>webservices</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                            <!--
                                All layers provisioned all together
                             -->
                            <execution>
                                <id>all-layers-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/test-all-layers</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>base-server</layer>
                                                <layer>batch-jberet</layer>
                                                <layer>bean-validation</layer>
                                                <layer>cdi</layer>
                                                <layer>cloud-profile</layer>
                                                <layer>cloud-server</layer>
                                                <layer>core-management</layer>
                                                <layer>core-server</layer>
                                                <layer>core-tools</layer>
                                                <layer>datasources</layer>
                                                <layer>datasources-web-server</layer>
                                                <layer>deployment-scanner</layer>
                                                <layer>discovery</layer>
                                                <layer>ee</layer>
                                                <layer>ee-security</layer>
                                                <layer>ejb</layer>
                                                <layer>ejb-http-invoker</layer>
                                                <layer>ejb-lite</layer>
                                                <layer>ejb-local-cache</layer>
                                                <layer>elytron</layer>
                                                <layer>embedded-activemq</layer>
                                                <layer>hibernate-search</layer>
                                                <layer>h2-datasource</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>h2-driver</layer>
                                                <layer>iiop-openjdk</layer>
                                                <layer>infinispan</layer>
                                                <layer>io</layer>
                                                <layer>jaxrs</layer>
                                                <layer>jaxrs-server</layer>
                                                <layer>jdr</layer>
                                                <layer>jgroups-aws</layer>
                                                <layer>jms-activemq</layer>
                                                <layer>jmx</layer>
                                                <layer>jmx-remoting</layer>
                                                <layer>jpa</layer>
                                                <layer>jsf</layer>
                                                <layer>jsonb</layer>
                                                <layer>jsonp</layer>
                                                <layer>logging</layer>
                                                <layer>mail</layer>
                                                <layer>management</layer>
                                                <layer>messaging-activemq</layer>
                                                <layer>mod_cluster</layer>
                                                <layer>naming</layer>
                                                <layer>observability</layer>
                                                <layer>opentelemetry</layer>
                                                <layer>pojo</layer>
                                                <layer>remoting</layer>
                                                <layer>request-controller</layer>
                                                <layer>resource-adapters</layer>
                                                <layer>sar</layer>
                                                <layer>security-manager</layer>
                                                <layer>singleton-local</layer>
                                                <layer>transactions</layer>
                                                <layer>undertow</layer>
                                                <layer>undertow-https</layer>
                                                <layer>undertow-load-balancer</layer>
                                                <layer>web-passivation</layer>
                                                <layer>web-console</layer>
                                                <layer>web-server</layer>
                                                <layer>webservices</layer>
                                                <!--
                                                    Galleon layers defined only in the wildfly-galleon-pack
                                                 -->
                                                <layer>microprofile-config</layer>
                                                <layer>microprofile-fault-tolerance</layer>
                                                <layer>microprofile-health</layer>
                                                <layer>microprofile-jwt</layer>
                                                <layer>microprofile-lra-coordinator</layer>
                                                <layer>microprofile-lra-participant</layer>
                                                <layer>microprofile-openapi</layer>
                                                <layer>microprofile-reactive-streams-operators</layer>
                                                <layer>microprofile-reactive-messaging</layer>
                                                <layer>microprofile-reactive-messaging-kafka</layer>
                                                <layer>microprofile-rest-client</layer>
                                                <layer>microprofile-telemetry</layer>
                                                <layer>microprofile-platform</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>

                           <!-- This is an all layers variant excluding jpa and adding jpa-distributed -->
                            <execution>
                                <id>all-layers-distributed-provisioning-full</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.excluded}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/test-all-layers-jpa-distributed</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>base-server</layer>
                                                <layer>batch-jberet</layer>
                                                <layer>bean-validation</layer>
                                                <layer>cdi</layer>
                                                <layer>cloud-profile</layer>
                                                <layer>cloud-server</layer>
                                                <layer>core-management</layer>
                                                <layer>core-server</layer>
                                                <layer>core-tools</layer>
                                                <layer>datasources</layer>
                                                <layer>datasources-web-server</layer>
                                                <layer>deployment-scanner</layer>
                                                <layer>discovery</layer>
                                                <layer>ee</layer>
                                                <layer>ee-security</layer>
                                                <layer>ejb</layer>
                                                <layer>ejb-dist-cache</layer>
                                                <layer>ejb-http-invoker</layer>
                                                <layer>ejb-lite</layer>
                                                <layer>elytron</layer>
                                                <layer>hibernate-search</layer>
                                                <layer>h2-datasource</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>h2-driver</layer>
                                                <layer>iiop-openjdk</layer>
                                                <layer>io</layer>
                                                <layer>jaxrs</layer>
                                                <layer>jaxrs-server</layer>
                                                <layer>jdr</layer>
                                                <layer>jms-activemq</layer>
                                                <layer>jmx</layer>
                                                <layer>jmx-remoting</layer>
                                                <layer>jpa-distributed</layer>
                                                <layer>jsf</layer>
                                                <layer>jsonb</layer>
                                                <layer>jsonp</layer>
                                                <layer>logging</layer>
                                                <layer>mail</layer>
                                                <layer>management</layer>
                                                <layer>messaging-activemq</layer>
                                                <layer>mod_cluster</layer>
                                                <layer>naming</layer>
                                                <layer>observability</layer>
                                                <layer>opentelemetry</layer>
                                                <layer>pojo</layer>
                                                <layer>remote-activemq</layer>
                                                <layer>remoting</layer>
                                                <layer>request-controller</layer>
                                                <layer>resource-adapters</layer>
                                                <layer>sar</layer>
                                                <layer>security-manager</layer>
                                                <layer>singleton-ha</layer>
                                                <layer>transactions</layer>
                                                <layer>undertow</layer>
                                                <layer>undertow-https</layer>
                                                <layer>undertow-load-balancer</layer>
                                                <layer>web-clustering</layer>
                                                <layer>web-console</layer>
                                                <layer>web-server</layer>
                                                <layer>webservices</layer>
                                                <!--
                                                    Galleon layers defined only in the wildfly-galleon-pack
                                                 -->
                                                <layer>microprofile-config</layer>
                                                <layer>microprofile-fault-tolerance</layer>
                                                <layer>microprofile-health</layer>
                                                <layer>microprofile-jwt</layer>
                                                <layer>microprofile-openapi</layer>
                                                <layer>microprofile-telemetry</layer>
                                                <layer>microprofile-platform</layer>
                                            </layers>
                                            <excluded-layers>
                                                <layer>jpa</layer>
                                                <layer>ejb-local-cache</layer>
                                            </excluded-layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <!-- Core Layers - These can't be tested in Core as they require Undertow -->
                            <execution>
                                <id>remoting-provisioning</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/remoting</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.feature.pack.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.feature.pack.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>remoting</layer>
                                                <layer>undertow</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>all-layers-provisioning-full-preview</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.only}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/test-all-layers</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>wildfly-preview-feature-pack</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>base-server</layer>
                                                <layer>batch-jberet</layer>
                                                <layer>bean-validation</layer>
                                                <layer>cdi</layer>
                                                <layer>cloud-profile</layer>
                                                <layer>cloud-server</layer>
                                                <layer>core-management</layer>
                                                <layer>core-server</layer>
                                                <layer>core-tools</layer>
                                                <layer>datasources</layer>
                                                <layer>datasources-web-server</layer>
                                                <layer>deployment-scanner</layer>
                                                <layer>discovery</layer>
                                                <layer>ee</layer>
                                                <layer>ee-security</layer>
                                                <layer>ejb</layer>
                                                <layer>ejb-http-invoker</layer>
                                                <layer>ejb-lite</layer>
                                                <layer>ejb-local-cache</layer>
                                                <layer>elytron</layer>
                                                <layer>embedded-activemq</layer>
                                                <layer>hibernate-search</layer>
                                                <layer>h2-datasource</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>h2-driver</layer>
                                                <layer>health</layer>
                                                <layer>iiop-openjdk</layer>
                                                <layer>io</layer>
                                                <layer>jaxrs</layer>
                                                <layer>jaxrs-server</layer>
                                                <layer>jdr</layer>
                                                <layer>jms-activemq</layer>
                                                <layer>jmx</layer>
                                                <layer>jmx-remoting</layer>
                                                <layer>jpa</layer>
                                                <layer>jsf</layer>
                                                <layer>jsonb</layer>
                                                <layer>jsonp</layer>
                                                <layer>logging</layer>
                                                <layer>mail</layer>
                                                <layer>management</layer>
                                                <layer>messaging-activemq</layer>
                                                <layer>metrics</layer>
                                                <layer>mod_cluster</layer>
                                                <layer>naming</layer>
                                                <layer>pojo</layer>
                                                <layer>remoting</layer>
                                                <layer>request-controller</layer>
                                                <layer>resource-adapters</layer>
                                                <layer>sar</layer>
                                                <layer>security-manager</layer>
                                                <layer>singleton-local</layer>
                                                <layer>transactions</layer>
                                                <layer>undertow</layer>
                                                <layer>undertow-https</layer>
                                                <layer>undertow-load-balancer</layer>
                                                <layer>web-passivation</layer>
                                                <layer>web-console</layer>
                                                <layer>web-server</layer>
                                                <layer>webservices</layer>
                                            </layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <execution>
                                <id>all-layers-distributed-provisioning-full-preview</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase.preview.only}</phase>
                                <configuration>
                                    <install-dir>${layers.install.dir}/test-all-layers-jpa-distributed</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${full.maven.groupId}</groupId>
                                            <artifactId>wildfly-preview-feature-pack</artifactId>
                                            <version>${full.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                        </feature-pack>
                                    </feature-packs>
                                    <configurations>
                                        <config>
                                            <model>standalone</model>
                                            <name>standalone.xml</name>
                                            <layers>
                                                <layer>base-server</layer>
                                                <layer>batch-jberet</layer>
                                                <layer>bean-validation</layer>
                                                <layer>cdi</layer>
                                                <layer>cloud-profile</layer>
                                                <layer>cloud-server</layer>
                                                <layer>core-management</layer>
                                                <layer>core-server</layer>
                                                <layer>core-tools</layer>
                                                <layer>datasources</layer>
                                                <layer>datasources-web-server</layer>
                                                <layer>deployment-scanner</layer>
                                                <layer>discovery</layer>
                                                <layer>ee</layer>
                                                <layer>ee-security</layer>
                                                <layer>ejb</layer>
                                                <layer>ejb-dist-cache</layer>
                                                <layer>ejb-http-invoker</layer>
                                                <layer>ejb-lite</layer>
                                                <layer>elytron</layer>
                                                <layer>hibernate-search</layer>
                                                <layer>h2-datasource</layer>
                                                <layer>h2-default-datasource</layer>
                                                <layer>h2-driver</layer>
                                                <layer>health</layer>
                                                <layer>iiop-openjdk</layer>
                                                <layer>io</layer>
                                                <layer>jaxrs</layer>
                                                <layer>jaxrs-server</layer>
                                                <layer>jdr</layer>
                                                <layer>jms-activemq</layer>
                                                <layer>jmx</layer>
                                                <layer>jmx-remoting</layer>
                                                <layer>jpa-distributed</layer>
                                                <layer>jsf</layer>
                                                <layer>jsonb</layer>
                                                <layer>jsonp</layer>
                                                <layer>logging</layer>
                                                <layer>mail</layer>
                                                <layer>management</layer>
                                                <layer>messaging-activemq</layer>
                                                <layer>metrics</layer>
                                                <layer>mod_cluster</layer>
                                                <layer>naming</layer>
                                                <layer>pojo</layer>
                                                <layer>remote-activemq</layer>
                                                <layer>remoting</layer>
                                                <layer>request-controller</layer>
                                                <layer>resource-adapters</layer>
                                                <layer>sar</layer>
                                                <layer>security-manager</layer>
                                                <layer>singleton-ha</layer>
                                                <layer>transactions</layer>
                                                <layer>undertow</layer>
                                                <layer>undertow-https</layer>
                                                <layer>undertow-load-balancer</layer>
                                                <layer>web-clustering</layer>
                                                <layer>web-console</layer>
                                                <layer>web-server</layer>
                                                <layer>webservices</layer>
                                            </layers>
                                            <excluded-layers>
                                                <layer>jpa</layer>
                                                <layer>ejb-local-cache</layer>
                                            </excluded-layers>
                                        </config>
                                    </configurations>
                                </configuration>
                            </execution>
                            <!-- Build all the default standard configs with passive+. -->
                            <execution>
                                <id>test-standalone-passive-plus</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${std.default.install.dir}/standalone</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                            <included-configs>
                                                <config>
                                                    <model>standalone</model>
                                                    <name>standalone.xml</name>
                                                </config>
                                            </included-configs>
                                        </feature-pack>
                                    </feature-packs>
                                </configuration>
                            </execution>
                            <execution>
                                <id>test-standalone-ha-passive-plus</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${std.default.install.dir}/standalone-ha</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                            <included-configs>
                                                <config>
                                                    <model>standalone</model>
                                                    <name>standalone-ha.xml</name>
                                                </config>
                                            </included-configs>
                                        </feature-pack>
                                    </feature-packs>
                                    <custom-config>ha-config.xml</custom-config>
                                </configuration>
                            </execution>
                            <execution>
                                <id>test-standalone-full-passive-plus</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${std.default.install.dir}/standalone-full</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                            <included-configs>
                                                <config>
                                                    <model>standalone</model>
                                                    <name>standalone-full.xml</name>
                                                </config>
                                            </included-configs>
                                        </feature-pack>
                                    </feature-packs>
                                    <custom-config>full-config.xml</custom-config>
                                </configuration>
                            </execution>
                            <execution>
                                <id>test-standalone-full-ha-passive-plus</id>
                                <goals>
                                    <goal>provision</goal>
                                </goals>
                                <phase>${provisioning.phase}</phase>
                                <configuration>
                                    <install-dir>${std.default.install.dir}/standalone-full-ha</install-dir>
                                    <feature-packs>
                                        <feature-pack>
                                            <groupId>${ee.maven.groupId}</groupId>
                                            <artifactId>${ee.feature.pack.artifactId}</artifactId>
                                            <version>${ee.maven.version}</version>
                                            <inherit-configs>false</inherit-configs>
                                            <inherit-packages>false</inherit-packages>
                                            <included-configs>
                                                <config>
                                                    <model>standalone</model>
                                                    <name>standalone-full-ha.xml</name>
                                                </config>
                                            </included-configs>
                                        </feature-pack>
                                    </feature-packs>
                                    <custom-config>full-ha-config.xml</custom-config>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>

                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <configuration>
                            <systemPropertyVariables>
                                <!-- maven.local.repo is set in parent pom.xml, system property surefire.system.args -->
                                <layers.install.root>${layers.install.dir}</layers.install.root>
                                <std.default.install.root>${std.default.install.dir}</std.default.install.root>
                                <jbossas.version>${project.parent.version}</jbossas.version>
                                <cleanup.tmp>${cleanup.tmp}</cleanup.tmp>
                                <layers.delete.installations>${layers.delete.installations}</layers.delete.installations>
                                <maven.repo.local>${maven.repo.local}</maven.repo.local>
                            </systemPropertyVariables>
                        </configuration>
                    </plugin>
                </plugins>
            </build>

</project>
